# 語音轉文字程式使用說明

## 🎯 程式功能
1. **語音錄製**：透過麥克風錄製語音並轉換為文字
2. **檔案上傳**：支援多種音訊格式（WAV, MP3, MP4, M4A, FLAC, AAC, OGG）
3. **多語言支援**：支援中文、英文、日文、韓文
4. **文檔導出**：可導出為TXT或DOCX格式
5. **雙引擎**：Google API（線上）+ Whisper（離線）

## 📁 檔案說明
- `improved_speech_to_text.py` - **改進版程式（推薦使用）**
- `voice_to_text_app.py` - 基礎版程式
- `speech_to_text.py` - 完整版程式
- `simple_speech_to_text.py` - 簡化版程式
- `啟動改進版語音轉文字.bat` - 改進版啟動腳本
- `install_speech_packages.bat` - 自動安裝腳本
- `speech_requirements.txt` - 套件需求清單

## 🚀 快速開始

### 步驟1：安裝套件
執行安裝腳本：
```bash
install_speech_packages.bat
```

### 步驟2：啟動程式（推薦使用改進版）
```bash
啟動改進版語音轉文字.bat
```

## ✨ 新功能特色

### 🎤 改善的錄音功能
1. **連續錄音模式**（推薦）：
   - 可以說多句話，中間的停頓不會結束錄音
   - 自動合併多個錄音段落
   - 3秒連續靜音後才自動停止

2. **單句錄音模式**：
   - 適合錄製單一句子
   - 錄音後自動停止

### 📁 多格式音訊支援
- **新增支援**：MP3, MP4, M4A, FLAC, AAC, OGG
- **自動轉換**：程式會自動將各種格式轉換為可識別的格式
- **原有支援**：WAV（最佳相容性）

### 🔧 雙引擎識別
1. **Google API**：
   - 需要網路連線
   - 識別速度快
   - 支援多種語言

2. **Whisper（OpenAI）**：
   - 完全離線運作
   - 識別準確度高
   - 自動下載模型

## 💡 使用指南

### 1. 錄音操作
1. **選擇錄音模式**：
   - 連續錄音：適合錄製對話或長段語音
   - 單句錄音：適合錄製單一指令或短句

2. **開始錄音**：
   - 點擊「開始錄音」
   - 清楚說話（可以有停頓）
   - 點擊「停止錄音」或等待自動停止

### 2. 檔案上傳
1. 點擊「選擇音訊檔案」
2. 選擇您的音訊檔案（支援多種格式）
3. 程式會自動載入和轉換

### 3. 識別設定
1. **選擇引擎**：
   - Google API：線上識別，速度快
   - Whisper：離線識別，準確度高

2. **選擇語言**：
   - 中文、英文或自動偵測

### 4. 開始轉換
- 點擊「開始語音轉文字」
- 等待轉換完成

### 5. 導出結果
- **TXT格式**：純文字檔案
- **DOCX格式**：Word文檔格式

## 🔧 技術改進

### 錄音功能優化
- ✅ 解決了停歇被視為結束的問題
- ✅ 支援多段錄音自動合併
- ✅ 智能靜音檢測
- ✅ 即時錄音狀態顯示

### 檔案格式支援
- ✅ 新增MP3/MP4支援
- ✅ 自動格式轉換
- ✅ 背景載入處理
- ✅ 錯誤提示優化

### 用戶體驗改善
- ✅ 更清晰的狀態提示
- ✅ 進度顯示
- ✅ 錯誤處理優化
- ✅ 介面美化

## 🛠 安裝依賴

### 核心套件
```bash
pip install SpeechRecognition
pip install pyaudio
pip install python-docx
pip install pydub
pip install openai-whisper
```

### 可選套件（用於音訊格式轉換）
```bash
pip install ffmpeg-python
```

## ❓ 常見問題

### Q1: 連續錄音時如何避免過早結束？
**A:** 使用「連續錄音」模式，程式會等待3秒連續靜音才停止，中間的短暫停頓不會結束錄音。

### Q2: 支援哪些音訊格式？
**A:** 支援 WAV, MP3, MP4, M4A, FLAC, AAC, OGG 等常見格式。

### Q3: MP3/MP4檔案無法載入怎麼辦？
**A:** 確保已安裝 pydub 套件：`pip install pydub`

### Q4: Whisper模型載入很慢？
**A:** 首次使用需要下載模型（約140MB），之後會快很多。

### Q5: 錄音品質不佳怎麼辦？
**A:** 
- 確保麥克風正常工作
- 減少背景噪音
- 說話清晰，適當音量
- 嘗試調整麥克風距離

## 📈 版本更新

### v2.0（改進版）- 當前版本
- ✅ 新增多格式音訊支援（MP3, MP4等）
- ✅ 改善連續錄音功能
- ✅ 優化用戶介面
- ✅ 增強錯誤處理

### v1.3
- ✅ 新增DOCX導出功能
- ✅ 改善UI介面和錯誤處理

### v1.2  
- ✅ 新增多語言支援

### v1.1
- ✅ 基本語音轉文字功能

## 🔒 隱私說明
- 使用Google API時，音訊會上傳至Google服務器進行處理
- 使用Whisper時，所有處理都在本地進行，不會上傳任何數據
- 程式不會永久儲存您的音訊檔案
- 臨時檔案會在處理完成後自動清理

## 📞 技術支援
如遇到問題，請檢查：
1. Python版本（建議3.8+）
2. 套件版本相容性
3. 系統權限設定（麥克風權限）
4. 網路連線狀態（使用Google API時）
5. 音訊檔案格式和品質
